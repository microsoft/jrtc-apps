# Copyright (c) Microsoft Corporation.
# Licensed under the MIT license.

codeletset_id: mac_detailed

codelet_descriptor:

  # - codelet_name: mac_sched_ul_bsr_indication
  #   codelet_path: ${JBPF_CODELETS}/mac/mac_sched_ul_bsr_indication.o
  #   hook_name: mac_sched_ul_bsr_indication
  #   priority: 1
  #   out_io_channel:
  #     - name: mac_sched_ul_bsr_indication_output_map
  #       forward_destination: DestinationUDP
  #       serde:
  #         file_path: ${JBPF_CODELETS}/mac/mac_sched_ul_bsr_indication:mac_sched_ul_bsr_indication_serializer.so
  #         protobuf:
  #           package_path: ${JBPF_CODELETS}/mac/mac_sched_ul_bsr_indication.pb
  #           msg_name: mac_sched_ul_bsr_indication

  - codelet_name: mac_sched_crc_stats
    codelet_path: ${JBPF_CODELETS}/mac/mac_sched_crc_stats.o
    hook_name: mac_sched_crc_indication
    priority: 1

  # - codelet_name: mac_sched_ul_phr_indication
  #   codelet_path: ${JBPF_CODELETS}/mac/mac_sched_ul_phr_indication.o
  #   hook_name: mac_sched_ul_phr_indication
  #   priority: 1
  #   out_io_channel:
  #     - name: mac_sched_ul_phr_indication_output_map
  #       forward_destination: DestinationUDP
  #       serde:
  #         file_path: ${JBPF_CODELETS}/mac/mac_sched_ul_phr_indication:mac_sched_ul_phr_indication_serializer.so
  #         protobuf:
  #           package_path: ${JBPF_CODELETS}/mac/mac_sched_ul_phr_indication.pb
  #           msg_name: mac_sched_ul_phr_indication

  - codelet_name: mac_stats_collect
    codelet_path: ${JBPF_CODELETS}/mac/mac_stats_collect.o
    hook_name: report_stats
    priority: 1
    out_io_channel:
      - name: output_map
        forward_destination: DestinationUDP
        serde:
          file_path: ${JBPF_CODELETS}/mac/mac_sched_crc_stats:mac_stats_serializer.so
          protobuf:
            package_path: ${JBPF_CODELETS}/mac/mac_sched_crc_stats.pb
            msg_name: mac_stats
    linked_maps:
      - map_name: stats_map_crc
        linked_codelet_name: mac_sched_crc_stats
        linked_map_name: stats_map_crc
      - map_name: crc_hash
        linked_codelet_name: mac_sched_crc_stats
        linked_map_name: crc_hash
      - map_name: crc_not_empty
        linked_codelet_name: mac_sched_crc_stats
        linked_map_name: crc_not_empty
      - map_name: cnt_loss
        linked_codelet_name: mac_sched_crc_stats
        linked_map_name: cnt_loss